<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GamR: Converting data into an Event Tree</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../gamr.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GamR
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">GammaROOT</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('d4/d4d/root_to_gamr.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Converting data into an Event Tree</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_docs_2md_2tree_2root2gamr"></a></p>
<p>The program root2gamr is used to create a TTree containing events as described in <a class="el" href="../../d0/d38/tree.html">About the Event Tree</a>.</p>
<p>The first step to creating a <a class="el" href="../../de/d62/namespace_gam_r.html">GamR</a> tree is defining the tree type. For this see <a class="el" href="../../de/dca/treetypes.html">Tree Definitions</a> to check if the type required exists already, and, if necessary edit <a class="el" href="../../d3/d1b/treetypes_8md.html">treetypes.md</a> and recompile to add your own. Once this has been completed, a configuration file will need to be created to handle the configuration for your specific conversion.</p>
<h1>Raw tree file</h1>
<p>The input for a <a class="el" href="../../de/d62/namespace_gam_r.html">GamR</a> tree is known as a "Raw tree". This is a very simple structure that contains a TTree called "RawTree". The raw tree should contain a branch for each measurement that could be made in a particular event. For example, the energy recorded by a particular detector, the time at which a detection occurred, or any other flag or piece of information associated with the event. root2gamr is a program that takes this raw tree and converts it into the <a class="el" href="../../de/d62/namespace_gam_r.html">GamR</a> event tree.</p>
<h1>Configuration file</h1>
<p>The configuration file handles all the information needed to create the <a class="el" href="../../de/d62/namespace_gam_r.html">GamR</a> tree. This file is an [.INI file] (<a href="http://en.wikipedia.org/wiki/INI_file">http://en.wikipedia.org/wiki/INI_file</a>), and is processed by the library <a href="https://github.com/benhoyt/inih">inih</a>.</p>
<p>The first section necessary is the [array] section, which contains the name [groups], which is a list of an arbitrary name for each of the detector groups for the desired tree type. After this, a list of detector names for each detector group should be given. For example:</p>
<div class="fragment"><div class="line">[array]</div>
<div class="line">groups = HPGE LABR</div>
<div class="line">HPGE = HPGE1 HGPE2 HPGE3 HGPE4</div>
<div class="line">LABR = LABR1 LABR2</div>
</div><!-- fragment --><p>This defines two groups (HPGE and LABR), corresponding to Germanium and Lanthanum Bromide detectors. There are four Germanium detectors (HPGE1 - HPGE4) and two Lanthanum Bromide detectors (LABR1 and LABR2).</p>
<p>After this section follows a section for each individual detector. The section names should be the detector names previously listed, and in each section a number of detector properties can be set.</p>
<h2>Detectors</h2>
<p>The properties and a brief description of their function is given in the following table</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Property   </th><th class="markdownTableHeadRight">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">id   </td><td class="markdownTableBodyRight">Unique (integer) identifier of the detector, stored in TDetector::ID    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">efficiency   </td><td class="markdownTableBodyRight">Detector efficiency, stored in TDetector::Eff    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">branches   </td><td class="markdownTableBodyRight">List of strings giving the branches in the input tree to assign to each measurement    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">calibration   </td><td class="markdownTableBodyRight">List of calibration strings    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">pollgate   </td><td class="markdownTableBodyRight"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">pollfreq   </td><td class="markdownTableBodyRight"></td></tr>
</table>
<h3>Calibration</h3>
<p>Each raw datum (from the source tree) will be written to the event tree, as well as a calibrated value. The calibration is defined by a string which is changed into a TFormula. The values of the each of the n branches are assigned to the first n parameters of the TFormula. The values x, y, z, and t, have special values as defined below. Additionally, the event number can be accessed by the n+1 parameter.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Value   </th><th class="markdownTableHeadRight">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">x   </td><td class="markdownTableBodyRight">Random sample from the uniform [0,1) distribution    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">y   </td><td class="markdownTableBodyRight">Random sample from a Gaussian distribution    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">z   </td><td class="markdownTableBodyRight">Standard deviation from the poll histogram    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">t   </td><td class="markdownTableBodyRight">Mean of the poll histogram   </td></tr>
</table>
<p>For example, a line in the configuration file for a detector with two measurements might be</p>
<div class="fragment"><div class="line">calibration = [0]?(([2]&gt;10000)?(([0]+x)*0.534-1.435):(([0]+x)*0.498-2.346)):[0]          [1]?(([1]+x)*0.1023):[1]</div>
</div><!-- fragment --><p>Note that:</p><ul>
<li>The symbol x is used to dither raw integer values</li>
<li>[0] represents the first datum, [1] the second datum, and [2] the event number</li>
<li>The ternary operator is used to both ensure that<ul>
<li>Calibrations are only applied to non-zero raw datums</li>
<li>For the first measurement, a different calibration is applied for events before number 10000 and after (i.e. in the case of a gain drift)</li>
</ul>
</li>
</ul>
<p>Other branch values can also be used in each string, so for example this is a valid statement</p>
<div class="fragment"><div class="line">calibration = [0]*1.0324+[1]            [1]*0.4358-[0]</div>
</div><!-- fragment --><p>Where the calibration string for each branch references the data from the other branches. Note however, that the data used are raw if the calibration for that branch has not been processed yet, or calibrated if it has. So in the previous example, the first [1] is the raw data from the second branch, whilst the second [0] (in the [1] calibration string) is the calibrated value, just previously calculated.</p>
<h3>Example detector section</h3>
<div class="fragment"><div class="line">[HPGE1]</div>
<div class="line">id = 1</div>
<div class="line">efficiency = 1</div>
<div class="line">require = 2</div>
<div class="line">calibration = [0]?(([0]+x)*0.50576713+0.65660738):[0] [1]?([1]+x)*0.10226634:[1]</div>
<div class="line">branches = m1.1_HPGe_OBI_1 m1.6_GeTAC</div>
</div><!-- fragment --><p>In this case, the detector HPGE1 is assigned the ID 1, branches corresponding to a branch for the energy (m1.1_HPGe_OBI_1) and time (m1.6_GeTAC). Both energy and time are required for the detector to have fired (require = 2), and appropriate calibration strings are assigned to each measurement.</p>
<h1>Running root2gamr</h1>
<p>After the [.INI file] has been created, the program root2gamr can be run. Running root2gamr with no arguments will print a help message that gives the options for correct usage. Basic options are given below.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadRight">Flag   </th><th class="markdownTableHeadRight">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-h   </td><td class="markdownTableBodyRight">Display help menu    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-i   </td><td class="markdownTableBodyRight">Input file name    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyRight">-c   </td><td class="markdownTableBodyRight">Configuration file name    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyRight">-o   </td><td class="markdownTableBodyRight">Output file containing the event tree   </td></tr>
</table>
<p>Additionally, a flag specifying the type of event is necessary. This corresponds to the type added in <a class="el" href="../../d3/d1b/treetypes_8md.html">treetypes.md</a>. For example</p>
<div class="fragment"><div class="line">root2gamr -i input_file.root -c my_conf.ini -o output.gamr.root --D321 </div>
</div><!-- fragment --><p>will take the raw file input_file.root and process it using the configuration specified in my_conf.ini, writing the output to output.gamr.root (which will be created). This is using the event type D321, which contains three groups of detectors: the first with three UInt_t measurements, the second with two UInt_t measurements, and the third with a single UInt_t. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Sep 4 2025 19:21:12 for GamR by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
