<!-- HTML header for doxygen 1.8.14-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>GamR: src/lib/coulex/Coulex.hh Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../gamr.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">GamR
   &#160;<span id="projectnumber">0.0.0</span>
   </div>
   <div id="projectbrief">GammaROOT</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(1); });
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('df/d7f/_coulex_8hh_source.html','../../'); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Coulex.hh</div></div>
</div><!--header-->
<div class="contents">
<a href="../../df/d7f/_coulex_8hh.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#ifndef GAMR_COULEX_COULEX_HH</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="preprocessor">#define GAMR_COULEX_COULEX_HH</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#include &lt;complex&gt;</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &lt;TMath.h&gt;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;<a class="code" href="../../df/d32/_misc_8hh.html">toolkit/Misc.hh</a>&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;<a class="code" href="../../da/da2/_ang_dist_8hh.html">angdist/AngDist.hh</a>&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d35/_eloss_8hh.html">Eloss.hh</a>&quot;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/d0f/_w_d_b_subs_8hh.html">WDBSubs.hh</a>&quot;</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span> </div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../de/d62/namespace_gam_r.html">GamR</a> {</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>    <span class="keyword">namespace </span><a class="code hl_namespace" href="../../d6/d76/namespace_gam_r_1_1_coulex.html">Coulex</a> {</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a05f705d48afc37fffba20f0a60726a39">   21</a></span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a05f705d48afc37fffba20f0a60726a39">rad2deg</a> = 360. / 2. / TMath::Pi();</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span>        <span class="comment">// Structure for passing level data to the MakeDatafile function    </span></div>
<div class="foldopen" id="foldopen00023" data-start="{" data-end="};">
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html">   23</a></span>        <span class="keyword">struct </span><a class="code hl_struct" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html">WDB_nuclvl</a> {</div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno"><a class="line" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a14fc28f9a9d39b9973fe382976cdc645">   24</a></span>            <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a14fc28f9a9d39b9973fe382976cdc645">spin</a>; <span class="comment">// Spin of state</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a1222553ef2a00cbaf40794016f6a5b32">   25</a></span>            <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a1222553ef2a00cbaf40794016f6a5b32">E</a>;   <span class="comment">// Energy of state</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno"><a class="line" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a5c968ff3a6062ede56bb889dfe8602c7">   26</a></span>            <span class="keywordtype">bool</span> <a class="code hl_variable" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a5c968ff3a6062ede56bb889dfe8602c7">par</a>;    <span class="comment">// Parity of state</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno"><a class="line" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a6a2f2eaee0cd4609199448781f07d46e">   27</a></span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a6a2f2eaee0cd4609199448781f07d46e">K_Band</a>;   <span class="comment">// K number in rotor model</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>        };</div>
</div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>        <span class="comment">// Structure for passing transition data to the MakeDatafile function</span></div>
<div class="foldopen" id="foldopen00031" data-start="{" data-end="};">
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno"><a class="line" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html">   31</a></span>        <span class="keyword">struct </span><a class="code hl_struct" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html">WDB_nuctrans</a> {</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno"><a class="line" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a7e877a5a6f25699cfcab48d416273d34">   32</a></span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a7e877a5a6f25699cfcab48d416273d34">lvl1</a>;   <span class="comment">// Lower level</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a5d0e1494efd2f67c19b5962c8a5f3035">   33</a></span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a5d0e1494efd2f67c19b5962c8a5f3035">lvl2</a>;   <span class="comment">// Upper level</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno"><a class="line" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a383dcf2cb37de53d1776c119421adbaf">   34</a></span>            <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a383dcf2cb37de53d1776c119421adbaf">B</a>;   <span class="comment">// Reduced matrix element in eb</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a4f15fc13c447a977f4944e55999bcc32">   35</a></span>            <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a4f15fc13c447a977f4944e55999bcc32">M</a>;     <span class="comment">// Multipolarity</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>        };</div>
</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>        <span class="comment">// This routine accepts beam and target information, and the dimensions and position of a square particle detector at phi=0, and calculates the average nuclear stat tensor across the detector.</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>        <span class="comment">// Nuclear levels and transitions from the nucleus of interest must be passed using the WDB_nuclvls and WDB_nuctrans vectors.</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>        <span class="comment">//GamR::AngDist::StatTensor *CoulexNucTensors(int Zbeam, float Abeam, int Ztgt, float Atgt, bool ProjDet, bool TgtEx, float E, float Q, float Tgtdensity, float Tgtthickness, int tenslvl, int nlvl, std::vector&lt;WDB_nuclvl&gt; &amp;lvls, int nEtran, std::vector&lt;WDB_nuctrans&gt; &amp;Etrans, int nMtran, std::vector&lt;WDB_nuctrans&gt; &amp;Mtrans, float PDetx, float PDety, float PDetz, double PDetr);</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>        </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>        <span class="comment">// This routine will ask a series of questions to input the information required for coulex and optionally the Qk calculation, then build the WDB_nuclvls and WDB_nuctrans one-dimensional arrays needed for the CoulexNucTens routine.</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>        <span class="comment">//void ExperimentalSetup(int &amp;Zbeam, double &amp;Abeam, int &amp;Ztgt, double &amp;Atgt, bool &amp;ProjectileDetected, bool &amp;TargetExcited, double &amp;Ebeam, double &amp;Qex, double &amp;TargetThickness, double &amp;TargetDensity, double &amp;PDetx, double &amp;PDety, double &amp;PDetz, double &amp;PDetr, int &amp;ngamma, int &amp;nstates, std::vector&lt;WDB_nuclvl&gt; &amp;NucLevels, int &amp;Tenslevel, int &amp;nEtrans, std::vector&lt;WDB_nuctrans&gt; &amp;Etrans, int &amp;nMtrans, std::vector&lt;WDB_nuctrans&gt; &amp;Mtrans, std::vector&lt;GamR::AngDist::SolidAttenuation&gt; *Qks = nullptr);</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>        </div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>        <span class="comment">// Gives the Winther-DeBoer codes a projectile energy and target scattering angle (CM) which calculates nuclear stat tensors after coulex, then copies the tensors and reaction cross-section for your chosen level into the variables provided (whether the target or projectile tensors are calculated is determined in the MakeDatafile routine).</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>        <span class="comment">// Please ensure rho is dimensioned [3][5] (k=0,2,4 q&lt;=0 to 2*k)</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>        <span class="keywordtype">void</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a75a76e9e6cd58b5d2dd0792788d32390">GP_AC_Tensors</a>(<span class="keywordtype">float</span> Ebeam, <span class="keywordtype">float</span> CMAng, <span class="keywordtype">int</span> lvl, std::complex&lt;double&gt; **rho, <span class="keywordtype">float</span> &amp;xsect);</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>        </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>        <span class="comment">// This function is a wrapper to handle datafile construction, reading and removal. Returns 0 on success, 1 on file write error, 2 on read error, and 3 on removal error.</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a97f94193e8a27067bda39495a4f4e005">setupcoulex</a>(<span class="keywordtype">int</span> Zbeam, <span class="keywordtype">float</span> Abeam, <span class="keywordtype">int</span> Ztgt, <span class="keywordtype">float</span> Atgt, <span class="keywordtype">int</span> grouptype, std::vector&lt;WDB_nuclvl&gt; &amp;nuclvls, std::vector&lt;WDB_nuctrans&gt; &amp;nucEtrans, std::vector&lt;WDB_nuctrans&gt; &amp;nucMtrans);</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>        </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>        <span class="comment">/* Creates the data file which FREADER will read to setup the common block variables for the coulex calculation. </span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">         * Total states is the total number of nuclear states to be considered in all level schemes, Z_P is projectile Z, A_P is projectile mass, Z_T is target Z, A_T is target mass, nucgroups is the number of different nuclear level schemes,</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">         * grouptype[nucgroups] specifies whether the group is a projectile(1) or target(2), nuclvls[nucgroups] specifies how many levels are in the level scheme provided for a scheme, nuclvl[nucgroups][nuclvls] is a struct containing level information,</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">         * nucEMtrans[nucgroups] is the number of reduced matrix elements between transitions provided, nucEMtran[nucgroups][nucE/Mtrans] is a structure containing sqrt(B(EM/MM)) values, and filename is an optional output name for the data file.</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">         * Function returns 0 on success, 1 on a file access error.</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">         */</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#ad94f425f805a30d355c0c5d04b4736c4">MakeDatafile</a>(<span class="keywordtype">int</span> Zbeam, <span class="keywordtype">float</span> Abeam, <span class="keywordtype">int</span> Ztgt, <span class="keywordtype">float</span> Atgt, <span class="keywordtype">int</span> grouptype, std::vector&lt;WDB_nuclvl&gt; &amp;nuclvls, std::vector&lt;WDB_nuctrans&gt; &amp;nucEtrans, std::vector&lt;WDB_nuctrans&gt; &amp;nucMtrans, std::string filename = <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>        </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        <span class="comment">// Calls the coulex setup and data file reading routines that are part of the Winther-DeBoer codes. This only needs to be done once. Use Makedatafile to setup the data file.</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a2f7b899a42bd6a1e2df9d55d26449acc">ReadDatafile</a>(std::string datafile=<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>        </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        <span class="comment">// Transforms cross-section from centre-of-mass to lab</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>        <span class="keywordtype">double</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#acdb93d9857283604c5d8106d50290b02">xcmlr</a>(<span class="keywordtype">double</span> anglab, <span class="keywordtype">double</span> angCM, <span class="keywordtype">double</span> Ap, <span class="keywordtype">double</span> At, <span class="keywordtype">double</span> Ep, <span class="keywordtype">double</span> Q, <span class="keywordtype">bool</span> Tgtex);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>        </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        <span class="comment">// :: DEPRECIATED See Eloss.hh for new code :: Simplified interface to the fortran-based eloss routine by A.E. Stuchbery based on Ziegler&#39;s stopping powers. Accepts a monoelemental target only. Dfoil can be 0 and will pull a value from SCOEF.dat.</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>        <span class="comment">// void Eloss(float Ein, float Abeam, int Zbeam, float Afoil, int Zfoil, float &amp;Dfoil, float FoilThickness, float &amp;Eout, float &amp;transittime, float &amp;range);</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>        </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>        <span class="comment">/* Routine to get reaction kinematics based on Marion and Young&#39;s solutions, originally writted in FORTRAN by A.E. Stuchbery.</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">         * Inputs: A1I is projectile mass, A2I is target mass, A3I is light recoil mass, A4I is heavy recoil mass, E1I is projectile energy, QEFFI is reaction energy and PSII is the light recoil angle.</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">         * Outputs: E3I is the light mass energy, E3AI is alt solution, E4I is heavy mass energy, E4AI is alt solution, ZETAI is heavy recoil angle, ZETAAI is alt solution, thetaI is light CM angle, thetaaI is alt solution, PHII is heavy CM angle, and PHIAI is alt soluiton.</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">         * The function returns a flag where 1= unique solution, 0= two solutions and -1= bad light recoil angle. */</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a8bda628a11d99b6ff94a88a338ffd590">Kinematics</a>(<span class="keywordtype">double</span> A1I, <span class="keywordtype">double</span> A2I, <span class="keywordtype">double</span> A3I, <span class="keywordtype">double</span> A4I, <span class="keywordtype">double</span> E1I, <span class="keywordtype">double</span> QEFFI, <span class="keywordtype">double</span> PSII, <span class="keywordtype">double</span> &amp;E3I, <span class="keywordtype">double</span> &amp;E3AI, <span class="keywordtype">double</span> &amp;E4I, <span class="keywordtype">double</span> &amp;E4AI, <span class="keywordtype">double</span> &amp;ZETAI, <span class="keywordtype">double</span> &amp;ZETAAI, <span class="keywordtype">double</span> &amp;thetaI, <span class="keywordtype">double</span> &amp;thetaaI, <span class="keywordtype">double</span> &amp;PHII, <span class="keywordtype">double</span> &amp;PHIAI);</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        </div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>        <span class="comment">// Draws the particle detector geometry using ASCII characters to assist user input</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>        <span class="keywordtype">void</span> <a class="code hl_function" href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a80c70c5c99095da3a8a10a05513f1d23">DrawSetup</a>();</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    }</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>}</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="a_ang_dist_8hh_html"><div class="ttname"><a href="../../da/da2/_ang_dist_8hh.html">AngDist.hh</a></div></div>
<div class="ttc" id="a_eloss_8hh_html"><div class="ttname"><a href="../../d5/d35/_eloss_8hh.html">Eloss.hh</a></div></div>
<div class="ttc" id="a_misc_8hh_html"><div class="ttname"><a href="../../df/d32/_misc_8hh.html">Misc.hh</a></div></div>
<div class="ttc" id="a_w_d_b_subs_8hh_html"><div class="ttname"><a href="../../db/d0f/_w_d_b_subs_8hh.html">WDBSubs.hh</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html">GamR::Coulex</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00027">Coulex.cc:27</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a05f705d48afc37fffba20f0a60726a39"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a05f705d48afc37fffba20f0a60726a39">GamR::Coulex::rad2deg</a></div><div class="ttdeci">const double rad2deg</div><div class="ttdef"><b>Definition</b> <a href="#l00021">Coulex.hh:21</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a2f7b899a42bd6a1e2df9d55d26449acc"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a2f7b899a42bd6a1e2df9d55d26449acc">GamR::Coulex::ReadDatafile</a></div><div class="ttdeci">int ReadDatafile(std::string datafile)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00287">Coulex.cc:287</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a75a76e9e6cd58b5d2dd0792788d32390"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a75a76e9e6cd58b5d2dd0792788d32390">GamR::Coulex::GP_AC_Tensors</a></div><div class="ttdeci">void GP_AC_Tensors(float Ebeam, float CMAng, int lvl, std::complex&lt; double &gt; **rho, float &amp;xsect)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00317">Coulex.cc:317</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a80c70c5c99095da3a8a10a05513f1d23"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a80c70c5c99095da3a8a10a05513f1d23">GamR::Coulex::DrawSetup</a></div><div class="ttdeci">void DrawSetup()</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00336">Coulex.cc:336</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a8bda628a11d99b6ff94a88a338ffd590"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a8bda628a11d99b6ff94a88a338ffd590">GamR::Coulex::Kinematics</a></div><div class="ttdeci">int Kinematics(double A1I, double A2I, double A3I, double A4I, double E1I, double QEFFI, double PSII, double &amp;E3I, double &amp;E3AI, double &amp;E4I, double &amp;E4AI, double &amp;ZETAI, double &amp;ZETAAI, double &amp;thetaI, double &amp;thetaaI, double &amp;PHII, double &amp;PHIAI)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00050">Coulex.cc:50</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_a97f94193e8a27067bda39495a4f4e005"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#a97f94193e8a27067bda39495a4f4e005">GamR::Coulex::setupcoulex</a></div><div class="ttdeci">int setupcoulex(int Zbeam, float Abeam, int Ztgt, float Atgt, int grouptype, std::vector&lt; WDB_nuclvl &gt; &amp;nuclvls, std::vector&lt; WDB_nuctrans &gt; &amp;nucEtrans, std::vector&lt; WDB_nuctrans &gt; &amp;nucMtrans)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00304">Coulex.cc:304</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_acdb93d9857283604c5d8106d50290b02"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#acdb93d9857283604c5d8106d50290b02">GamR::Coulex::xcmlr</a></div><div class="ttdeci">double xcmlr(double anglab, double angCM, double Ap, double At, double Ep, double Q, bool Tgtex)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00182">Coulex.cc:182</a></div></div>
<div class="ttc" id="anamespace_gam_r_1_1_coulex_html_ad94f425f805a30d355c0c5d04b4736c4"><div class="ttname"><a href="../../d6/d76/namespace_gam_r_1_1_coulex.html#ad94f425f805a30d355c0c5d04b4736c4">GamR::Coulex::MakeDatafile</a></div><div class="ttdeci">int MakeDatafile(int Zbeam, float Abeam, int Ztgt, float Atgt, int grouptype, std::vector&lt; WDB_nuclvl &gt; &amp;nuclvls, std::vector&lt; WDB_nuctrans &gt; &amp;nucEtrans, std::vector&lt; WDB_nuctrans &gt; &amp;nucMtrans, std::string filename)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d58/_coulex_8cc_source.html#l00229">Coulex.cc:229</a></div></div>
<div class="ttc" id="anamespace_gam_r_html"><div class="ttname"><a href="../../de/d62/namespace_gam_r.html">GamR</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/ddb/_gain_8cc_source.html#l00019">Gain.cc:19</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl_html"><div class="ttname"><a href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html">GamR::Coulex::WDB_nuclvl</a></div><div class="ttdef"><b>Definition</b> <a href="#l00023">Coulex.hh:23</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl_html_a1222553ef2a00cbaf40794016f6a5b32"><div class="ttname"><a href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a1222553ef2a00cbaf40794016f6a5b32">GamR::Coulex::WDB_nuclvl::E</a></div><div class="ttdeci">float E</div><div class="ttdef"><b>Definition</b> <a href="#l00025">Coulex.hh:25</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl_html_a14fc28f9a9d39b9973fe382976cdc645"><div class="ttname"><a href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a14fc28f9a9d39b9973fe382976cdc645">GamR::Coulex::WDB_nuclvl::spin</a></div><div class="ttdeci">float spin</div><div class="ttdef"><b>Definition</b> <a href="#l00024">Coulex.hh:24</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl_html_a5c968ff3a6062ede56bb889dfe8602c7"><div class="ttname"><a href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a5c968ff3a6062ede56bb889dfe8602c7">GamR::Coulex::WDB_nuclvl::par</a></div><div class="ttdeci">bool par</div><div class="ttdef"><b>Definition</b> <a href="#l00026">Coulex.hh:26</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl_html_a6a2f2eaee0cd4609199448781f07d46e"><div class="ttname"><a href="../../d8/dc4/struct_gam_r_1_1_coulex_1_1_w_d_b__nuclvl.html#a6a2f2eaee0cd4609199448781f07d46e">GamR::Coulex::WDB_nuclvl::K_Band</a></div><div class="ttdeci">int K_Band</div><div class="ttdef"><b>Definition</b> <a href="#l00027">Coulex.hh:27</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans_html"><div class="ttname"><a href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html">GamR::Coulex::WDB_nuctrans</a></div><div class="ttdef"><b>Definition</b> <a href="#l00031">Coulex.hh:31</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans_html_a383dcf2cb37de53d1776c119421adbaf"><div class="ttname"><a href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a383dcf2cb37de53d1776c119421adbaf">GamR::Coulex::WDB_nuctrans::B</a></div><div class="ttdeci">float B</div><div class="ttdef"><b>Definition</b> <a href="#l00034">Coulex.hh:34</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans_html_a4f15fc13c447a977f4944e55999bcc32"><div class="ttname"><a href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a4f15fc13c447a977f4944e55999bcc32">GamR::Coulex::WDB_nuctrans::M</a></div><div class="ttdeci">int M</div><div class="ttdef"><b>Definition</b> <a href="#l00035">Coulex.hh:35</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans_html_a5d0e1494efd2f67c19b5962c8a5f3035"><div class="ttname"><a href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a5d0e1494efd2f67c19b5962c8a5f3035">GamR::Coulex::WDB_nuctrans::lvl2</a></div><div class="ttdeci">int lvl2</div><div class="ttdef"><b>Definition</b> <a href="#l00033">Coulex.hh:33</a></div></div>
<div class="ttc" id="astruct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans_html_a7e877a5a6f25699cfcab48d416273d34"><div class="ttname"><a href="../../d1/d10/struct_gam_r_1_1_coulex_1_1_w_d_b__nuctrans.html#a7e877a5a6f25699cfcab48d416273d34">GamR::Coulex::WDB_nuctrans::lvl1</a></div><div class="ttdeci">int lvl1</div><div class="ttdef"><b>Definition</b> <a href="#l00032">Coulex.hh:32</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.14-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_c85d3e3c5052e9ad9ce18c6863244a25.html">lib</a></li><li class="navelem"><a class="el" href="../../dir_6a79cfc049500787c362cfe00e651ec0.html">coulex</a></li><li class="navelem"><a class="el" href="../../df/d7f/_coulex_8hh.html">Coulex.hh</a></li>
    <li class="footer">Generated on Tue Apr 15 2025 13:33:16 for GamR by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
